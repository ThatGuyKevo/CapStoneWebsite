{"ast":null,"code":"import _regeneratorRuntime from\"/Users/thatguykev/Desktop/eCommerce-Website/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/thatguykev/Desktop/eCommerce-Website/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/thatguykev/Desktop/eCommerce-Website/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"/Users/thatguykev/Desktop/eCommerce-Website/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import axios from'axios';import{useContext,useEffect,useReducer}from'react';import{useNavigate,useParams}from'react-router-dom';import Row from'react-bootstrap/Row';import Col from'react-bootstrap/Col';import Card from'react-bootstrap/Card';import Badge from'react-bootstrap/Badge';import Button from'react-bootstrap/Button';import ListGroup from'react-bootstrap/ListGroup';import Rating from'../components/Rating';import{Helmet}from'react-helmet-async';import LoadingBox from'../components/LoadingBox';import MessageBox from'../components/MessageBox';import{getError}from'../utils';import{Store}from'../Store';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var reducer=function reducer(state,action){switch(action.type){case'FETCH_REQUEST':return _objectSpread(_objectSpread({},state),{},{loading:true});case'FETCH_SUCCESS':return _objectSpread(_objectSpread({},state),{},{product:action.payload,loading:false});case'FETCH_FAIL':return _objectSpread(_objectSpread({},state),{},{loading:false,error:action.payload});default:return state;}};function ProductScreen(){var navigate=useNavigate();var params=useParams();var slug=params.slug;var _useReducer=useReducer(reducer,{product:[],loading:true,error:''}),_useReducer2=_slicedToArray(_useReducer,2),_useReducer2$=_useReducer2[0],loading=_useReducer2$.loading,error=_useReducer2$.error,product=_useReducer2$.product,dispatch=_useReducer2[1];useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch({type:'FETCH_REQUEST'});_context.prev=1;_context.next=4;return axios.get(\"/api/products/slug\".concat(slug));case 4:result=_context.sent;dispatch({type:'FETCH_SUCCESS',payload:result.data});_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);dispatch({type:'FETCH_FAIL',payload:getError(_context.t0)});case 11:case\"end\":return _context.stop();}}},_callee,null,[[1,8]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();},[slug]);var _useContext=useContext(Store),state=_useContext.state,cxtDispatch=_useContext.dispatch;var cart=state.cart;var addToCartHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var existItem,quantity,_yield$axios$get,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:existItem=cart.cartItems.find(function(x){return x._id===product._id;});quantity=existItem?existItem.quantity+1:1;_context2.next=4;return axios.get(\"/api/products/\".concat(product._id));case 4:_yield$axios$get=_context2.sent;data=_yield$axios$get.data;if(!(data.countInStock<quantity)){_context2.next=9;break;}window.alert('Sorry. Product is out of stock');return _context2.abrupt(\"return\");case 9:cxtDispatch({type:'CART_ADD_ITEM',payload:_objectSpread(_objectSpread({},product),{},{quantity:quantity})});navigate('/cart');case 11:case\"end\":return _context2.stop();}}},_callee2);}));return function addToCartHandler(){return _ref2.apply(this,arguments);};}();return loading?/*#__PURE__*/_jsx(LoadingBox,{}):error?/*#__PURE__*/_jsx(MessageBox,{variant:\"danger\",children:error}):error?/*#__PURE__*/_jsx(\"div\",{children:error}):/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsx(\"img\",{className:\"img-large\",src:product.image,alt:product.name})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(ListGroup,{varient:\"flush\",children:[/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(Helmet,{children:/*#__PURE__*/_jsx(\"title\",{children:product.name})}),/*#__PURE__*/_jsx(\"h1\",{children:product.name})]}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(Rating,{rating:product.rating,numReviews:product.numReviews})}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[\"Price : $\",product.price]}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[\"Description:\",/*#__PURE__*/_jsx(\"p\",{children:product.description})]})]})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Price:\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",product.price]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Status:\"}),/*#__PURE__*/_jsx(Col,{children:product.countInStock>0?/*#__PURE__*/_jsx(Badge,{bg:\"success\",children:\"In Stock\"}):/*#__PURE__*/_jsx(Badge,{bg:\"danger\",children:\"Unavailable\"})})]})}),product.countInStock>0&&/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(\"div\",{className:\"d-grid\",children:/*#__PURE__*/_jsx(Button,{onClick:addToCartHandler,variant:\"primary\",children:\"Add to Cart\"})})})]})})})})]})});}export default ProductScreen;","map":{"version":3,"names":["axios","useContext","useEffect","useReducer","useNavigate","useParams","Row","Col","Card","Badge","Button","ListGroup","Rating","Helmet","LoadingBox","MessageBox","getError","Store","reducer","state","action","type","loading","product","payload","error","ProductScreen","navigate","params","slug","dispatch","fetchData","get","result","data","cxtDispatch","cart","addToCartHandler","existItem","cartItems","find","x","_id","quantity","countInStock","window","alert","image","name","rating","numReviews","price","description"],"sources":["/Users/thatguykev/Desktop/eCommerce-Website/client/src/screens/ProductScreen.js"],"sourcesContent":["import axios from 'axios';\nimport { useContext, useEffect, useReducer } from 'react';\nimport {useNavigate,useParams} from 'react-router-dom';\nimport Row from 'react-bootstrap/Row'\nimport Col from 'react-bootstrap/Col'\nimport Card from 'react-bootstrap/Card'\nimport Badge from 'react-bootstrap/Badge'\nimport Button from 'react-bootstrap/Button'\nimport ListGroup from 'react-bootstrap/ListGroup';\nimport Rating from '../components/Rating';\nimport { Helmet } from 'react-helmet-async';\nimport LoadingBox from '../components/LoadingBox';\nimport MessageBox from '../components/MessageBox';\nimport { getError } from '../utils';\nimport { Store } from '../Store';\n\n\n    const reducer =(state,action) => {\n        switch(action.type) {\n            case 'FETCH_REQUEST':\n                return{...state,loading: true};\n            case'FETCH_SUCCESS':\n                return{...state,product: action.payload, loading: false};\n            case 'FETCH_FAIL':\n                return {...state,loading: false, error: action.payload };\n            default:\n                return state;\n        }\n    };\n    \n    function ProductScreen() {\n        const navigate = useNavigate();\n        const params = useParams();\n        const {slug} = params;\n        \n        const [{loading,error,product},dispatch] = useReducer(reducer, {\n            product: [],\n            loading:true,\n            error: '',\n        });\n\n        useEffect(()=>{\n            const fetchData =async () =>{\n                dispatch({type: 'FETCH_REQUEST'})\n                try{\n                    const result = await axios.get(`/api/products/slug${slug}`);\n                    dispatch({type: 'FETCH_SUCCESS', payload: result.data });\n                } catch(err) {\n                    dispatch({type: 'FETCH_FAIL', payload: getError(err)});\n                }                \n            };\n            fetchData();\n        },[slug]);\n\n    const {state, dispatch: cxtDispatch} = useContext(Store);\n    const {cart} = state;\n    const addToCartHandler = async() => {\n        const existItem = cart.cartItems.find((x) => x._id === product._id);\n        const quantity = existItem ? existItem.quantity + 1 : 1;\n        const {data} = await axios.get(`/api/products/${product._id}`);\n        if (data.countInStock < quantity) {\n            window.alert('Sorry. Product is out of stock');\n            return;\n        }\n\n        cxtDispatch({\n            type:'CART_ADD_ITEM',\n            payload: {...product, quantity},\n        });\n        navigate('/cart');\n    }\n\n    return loading ? (\n        <LoadingBox />\n        )   :\n        error ? (\n        <MessageBox variant=\"danger\">{error}</MessageBox>\n        ) : error?  (\n        <div>{error}</div>\n        ) : (\n        <div>\n            <Row>\n                <Col md={6}>\n                <img\n                    className=\"img-large\"\n                    src={product.image}\n                    alt={product.name}\n                ></img>\n                </Col>\n                <Col md={3}>\n                    <ListGroup varient=\"flush\">\n                        <ListGroup.Item>\n                            <Helmet>\n                                <title>{product.name}</title>\n                            </Helmet>\n                            <h1>{product.name}</h1>\n                        </ListGroup.Item>\n                        <ListGroup.Item>\n                            <Rating\n                            rating={product.rating}\n                            numReviews={product.numReviews}\n                            ></Rating>\n                        </ListGroup.Item>\n                        <ListGroup.Item>\n                            Price : ${product.price}\n                        </ListGroup.Item>\n                        <ListGroup.Item>\n                            Description:\n                            <p>{product.description}</p>\n                        </ListGroup.Item>\n                    </ListGroup>\n                    \n                </Col>\n                <Col md={3}>\n                    <Card>\n                        <Card.Body>\n                            <ListGroup variant=\"flush\">\n                            <ListGroup.Item>\n                                <Row>\n                                    <Col>Price:</Col>\n                                    <Col>${product.price}</Col>                                    \n                                </Row>\n                            </ListGroup.Item>\n                            <ListGroup.Item>\n                                <Row>\n                                    <Col>Status:</Col>\n                                    <Col>\n                                    {product.countInStock>0? \n                                    <Badge bg=\"success\">In Stock</Badge>\n                                    :\n                                    <Badge bg=\"danger\">Unavailable</Badge>\n                                    }</Col>                                    \n                                </Row>\n                            </ListGroup.Item>\n                            \n                            {product.countInStock > 0 && (\n                                <ListGroup.Item>\n                                    <div className=\"d-grid\">\n                                    <Button onClick={addToCartHandler} variant=\"primary\">\n                                        Add to Cart\n                                    </Button>\n                                    </div>\n                                </ListGroup.Item>\n                            )}\n\n                            </ListGroup>\n                        </Card.Body>\n                    </Card>\n                </Col>\n            </Row>\n        </div>\n    );\n}\n\nexport default ProductScreen;"],"mappings":"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"},"metadata":{},"sourceType":"module"}